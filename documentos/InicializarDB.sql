-- MySQL Script generated by MySQL Workbench
-- Fri Sep  1 01:42:13 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema lab1
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema lab1
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `lab1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci ;
USE `lab1` ;

-- -----------------------------------------------------
-- Table `lab1`.`departamento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab1`.`departamento` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nombreDepartamento` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `departamento_UNIQUE` (`nombreDepartamento` ASC) VISIBLE,
  UNIQUE INDEX `id_UNIQUE` (`id` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab1`.`municipio`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab1`.`municipio` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `area` FLOAT NOT NULL,
  `presupuesto` INT NOT NULL,
  `gobernador` INT NOT NULL,
  `departamento` INT NOT NULL,
  UNIQUE INDEX `nombre_UNIQUE` (`nombre` ASC) VISIBLE,
  INDEX `ubicacionMunicipio_idx` (`departamento` ASC) VISIBLE,
  UNIQUE INDEX `departamento_UNIQUE` (`departamento` ASC) VISIBLE,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id_UNIQUE` (`id` ASC) VISIBLE,
  CONSTRAINT `quienGobierna`
    FOREIGN KEY (`gobernador`)
    REFERENCES `lab1`.`persona` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `ubicacionMunicipio`
    FOREIGN KEY (`departamento`)
    REFERENCES `lab1`.`departamento` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 1
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab1`.`persona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab1`.`persona` (
  `id` INT NOT NULL,
  `nombre` VARCHAR(45) NOT NULL DEFAULT 'nn',
  `apellido` VARCHAR(45) NOT NULL DEFAULT 'nn',
  `sexo` INT(2) NOT NULL DEFAULT 0,
  `edad` INT NOT NULL DEFAULT 0,
  `telefono` BIGINT(10) UNSIGNED ZEROFILL NOT NULL DEFAULT '0000000000',
  `vivienda` INT NULL,
  `responsable` INT NULL,
  UNIQUE INDEX `id_UNIQUE` (`id` ASC) VISIBLE,
  INDEX `viviendaHabitada_idx` (`vivienda` ASC) VISIBLE,
  INDEX `responsable_idx` (`responsable` ASC) VISIBLE,
  PRIMARY KEY (`id`),
  CONSTRAINT `viviendaHabitada`
    FOREIGN KEY (`vivienda`)
    REFERENCES `lab1`.`vivienda` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `responsable`
    FOREIGN KEY (`responsable`)
    REFERENCES `lab1`.`persona` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 1
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab1`.`persona_has_vivienda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab1`.`persona_has_vivienda` (
  `persona_id` INT NOT NULL,
  `vivienda_id` INT NOT NULL,
  PRIMARY KEY (`persona_id`, `vivienda_id`),
  INDEX `fk_persona_has_vivienda_vivienda1_idx` (`vivienda_id` ASC) VISIBLE,
  INDEX `fk_persona_has_vivienda_persona1_idx` (`persona_id` ASC) VISIBLE,
  CONSTRAINT `fk_persona_has_vivienda_persona1`
    FOREIGN KEY (`persona_id`)
    REFERENCES `lab1`.`persona` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_persona_has_vivienda_vivienda1`
    FOREIGN KEY (`vivienda_id`)
    REFERENCES `lab1`.`vivienda` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab1`.`vivienda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab1`.`vivienda` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `direccion` VARCHAR(45) NOT NULL,
  `capacidad` INT NOT NULL,
  `niveles` INT NOT NULL DEFAULT '1',
  `municipio` INT NOT NULL,
  `dueño` INT NOT NULL,
  UNIQUE INDEX `direccion_UNIQUE` (`direccion` ASC) VISIBLE,
  INDEX `ubicadaen_idx` (`municipio` ASC) VISIBLE,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id_UNIQUE` (`id` ASC) VISIBLE,
  CONSTRAINT `ubicadaen`
    FOREIGN KEY (`municipio`)
    REFERENCES `lab1`.`municipio` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 1
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Agregar primer registro
-- -----------------------------------------------------
INSERT INTO `lab1`.`persona` (id) 
	VALUES (1);
INSERT INTO `lab1`.`departamento` (`nombreDepartamento` ) 
	VALUES ('NN');
INSERT INTO `lab1`.`municipio` (`nombre`, `area`, `presupuesto`, `gobernador`, `departamento`) 
	VALUES ("NN", 0, 0, 1, 1);
INSERT INTO `lab1`.`vivienda` (`direccion`, `capacidad`, `niveles`, `municipio`, `dueño`) 
	VALUES ("NN",1,1,1,1);
INSERT INTO `lab1`.`persona_has_vivienda` (`persona_id`,`vivienda_id`) 
	VALUES (1,1);
UPDATE `lab1`.`persona`
SET `vivienda` = 1, `responsable` = 1 WHERE `id` = 1;

ALTER TABLE `lab1`.`persona` 
DROP FOREIGN KEY `responsable`,
DROP FOREIGN KEY `viviendaHabitada`;
ALTER TABLE `lab1`.`persona` 
CHANGE COLUMN `vivienda` `vivienda` INT NOT NULL ,
CHANGE COLUMN `responsable` `responsable` INT NOT NULL ;
ALTER TABLE `lab1`.`persona` 
ADD CONSTRAINT `responsable`
  FOREIGN KEY (`responsable`)
  REFERENCES `lab1`.`persona` (`id`),
ADD CONSTRAINT `viviendaHabitada`
  FOREIGN KEY (`vivienda`)
  REFERENCES `lab1`.`vivienda` (`id`);
  
-- -----------------------------------------------------
-- Ingresar datos
-- -----------------------------------------------------
insert into departamento (nombreDepartamento) values ('Amazonas');
insert into departamento (nombreDepartamento) values ('Antioquia');
insert into departamento (nombreDepartamento) values ('Arauca');
insert into departamento (nombreDepartamento) values ('Atlantico');
insert into departamento (nombreDepartamento) values ('Bolivar');
insert into departamento (nombreDepartamento) values ('Boyaca');
insert into departamento (nombreDepartamento) values ('Caldas');
insert into departamento (nombreDepartamento) values ('Caqueta');
insert into departamento (nombreDepartamento) values ('Casanare');
insert into departamento (nombreDepartamento) values ('Cauca');
insert into departamento (nombreDepartamento) values ('Cesar');
insert into departamento (nombreDepartamento) values ('Choco');
insert into departamento (nombreDepartamento) values ('Cordoba');
insert into departamento (nombreDepartamento) values ('Cundinamarca');
insert into departamento (nombreDepartamento) values ('Guainia');
insert into departamento (nombreDepartamento) values ('Guaviare');
insert into departamento (nombreDepartamento) values ('Huila');
insert into departamento (nombreDepartamento) values ('La Guajira');
insert into departamento (nombreDepartamento) values ('Magdalena');
insert into departamento (nombreDepartamento) values ('Meta');
insert into departamento (nombreDepartamento) values ('Narino');
insert into departamento (nombreDepartamento) values ('Norte de Santander');
insert into departamento (nombreDepartamento) values ('Putumayo');
insert into departamento (nombreDepartamento) values ('Quindio');
insert into departamento (nombreDepartamento) values ('Risaralda');
insert into departamento (nombreDepartamento) values ('San Andres y Providencia');
insert into departamento (nombreDepartamento) values ('Santander');
insert into departamento (nombreDepartamento) values ('Sucre');
insert into departamento (nombreDepartamento) values ('Tolima');
insert into departamento (nombreDepartamento) values ('Valle del Cauca');
insert into departamento (nombreDepartamento) values ('Vaupes');
insert into departamento (nombreDepartamento) values ('Vichada');

INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (2,'Persona 2', 'Apellido 2',2, 24, 1234237890,1,1);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (3,'Persona 3', 'Apellido 3',2, 31, 1234367890,1,2);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (4,'Persona 4', 'Apellido 4',2, 32, 1234545890,1,3);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (5,'Persona 5', 'Apellido 5',2, 35, 1234515890,1,4);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (6,'Persona 6', 'Apellido 6',1, 24, 1234545890,1,5);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (7,'Persona 7', 'Apellido 7',1, 25, 1234568990,1,6);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (8,'Persona 8', 'Apellido 8',1, 36, 1234569890,1,7);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (9,'Persona 9', 'Apellido 9',0, 45, 1234563690,1,8);
INSERT INTO Persona (id,nombre, apellido, sexo, edad, telefono, vivienda, responsable) VALUES (10,'Persona 10', 'Apellido 10',1, 25, 1237267890,1,9);

INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 2', 100.0, 100000, 2, 12);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 3', 100.0, 1003000, 3, 13);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 4', 100.0, 103000, 4, 14);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 5', 100.0, 1001000, 5, 15);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 6', 100.0, 1000500, 6, 16);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 7', 100.0, 1000400, 7, 17);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 8', 100.0, 1004000, 8, 18);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 9', 100.0, 1005000, 9, 19);
INSERT INTO Municipio (nombre, area, presupuesto, gobernador,departamento) VALUES ('Municipio 10', 100.0, 1006000, 10, 20);

INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 1', 4, 1, 1,1);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 2', 5, 2, 2,2);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 3', 3, 1, 3,3);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 4', 4, 1, 4,4);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 5', 6, 2, 5,5);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 6', 7, 3, 6,6);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 7', 4, 3, 7,7);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 8', 3, 1, 8,8);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 9', 2, 1, 9,9);
INSERT INTO Vivienda (direccion ,capacidad, niveles, municipio, dueño) VALUES ('Direccion 10', 4, 2, 10,10);

INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (2, 2);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (3, 3);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (4, 4);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (5, 5);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (6, 6);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (7, 7);
INSERT INTO Persona_has_vivienda (Persona_id, Vivienda_id) VALUES (8, 8);